{"remainingRequest":"/Users/crocslut/Desktop/abj_cloud_assessment/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/crocslut/Desktop/abj_cloud_assessment/src/views/apps/chat/ChatLog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/crocslut/Desktop/abj_cloud_assessment/src/views/apps/chat/ChatLog.vue","mtime":1634376356106},{"path":"/Users/crocslut/Desktop/abj_cloud_assessment/node_modules/cache-loader/dist/cjs.js","mtime":1634370900025},{"path":"/Users/crocslut/Desktop/abj_cloud_assessment/node_modules/babel-loader/lib/index.js","mtime":1634273594024},{"path":"/Users/crocslut/Desktop/abj_cloud_assessment/node_modules/cache-loader/dist/cjs.js","mtime":1634370900025},{"path":"/Users/crocslut/Desktop/abj_cloud_assessment/node_modules/vue-loader/lib/index.js","mtime":1634373319752}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0ewogICAgcHJvcHM6IHsKICAgICAgICB1c2VySWQ6IHsKICAgICAgICAgICAgdHlwZTogTnVtYmVyLAogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICB9CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICBjaGF0RGF0YSgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NoYXQvY2hhdERhdGFPZlVzZXInXSh0aGlzLnVzZXJJZCk7CiAgICAgICAgfSwKICAgICAgICBhY3RpdmVVc2VySW1nKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuQXBwQWN0aXZlVXNlci5waG90b1VSTDsKICAgICAgICB9LAogICAgICAgIHNlbmRlckltZygpIHsKICAgICAgICAgICAgcmV0dXJuIChpc1NlbnRCeUFjdGl2ZVVzZXIpID0+IHsKICAgICAgICAgICAgICAgIGlmIChpc1NlbnRCeUFjdGl2ZVVzZXIpIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5BcHBBY3RpdmVVc2VyLnBob3RvVVJMCiAgICAgICAgICAgICAgICBlbHNlIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjaGF0L2NvbnRhY3QnXSh0aGlzLnVzZXJJZCkucGhvdG9VUkwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgaGFzU2VudFByZXZpb3VzTXNnKCkgewogICAgICAgICAgICByZXR1cm4gKGxhc3Rfc2VuZGVyLCBjdXJyZW50X3NlbmRlcikgPT4gbGFzdF9zZW5kZXIgPT0gY3VycmVudF9zZW5kZXIKICAgICAgICB9LAogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBpc1NhbWVEYXkodGltZV90bywgdGltZV9mcm9tKSB7CiAgICAgICAgICAgIGNvbnN0IGRhdGVfdGltZV90byA9IG5ldyBEYXRlKERhdGUucGFyc2UodGltZV90bykpCiAgICAgICAgICAgIGNvbnN0IGRhdGVfdGltZV9mcm9tID0gbmV3IERhdGUoRGF0ZS5wYXJzZSh0aW1lX2Zyb20pKTsKICAgICAgICAgICAgcmV0dXJuIGRhdGVfdGltZV90by5nZXRGdWxsWWVhcigpID09PSBkYXRlX3RpbWVfZnJvbS5nZXRGdWxsWWVhcigpICYmCiAgICAgICAgICAgICAgICBkYXRlX3RpbWVfdG8uZ2V0TW9udGgoKSA9PT0gZGF0ZV90aW1lX2Zyb20uZ2V0TW9udGgoKSAmJgogICAgICAgICAgICAgICAgZGF0ZV90aW1lX3RvLmdldERhdGUoKSA9PT0gZGF0ZV90aW1lX2Zyb20uZ2V0RGF0ZSgpOwogICAgICAgIH0sCiAgICAgICAgdG9EYXRlKHRpbWUpIHsKICAgICAgICAgICAgY29uc3QgbG9jYWxlID0gImVuLXVzIjsKICAgICAgICAgICAgY29uc3QgZGF0ZV9vYmogPSBuZXcgRGF0ZShEYXRlLnBhcnNlKHRpbWUpKTsKICAgICAgICAgICAgY29uc3QgbW9udGhOYW1lPSBkYXRlX29iai50b0xvY2FsZVN0cmluZyhsb2NhbGUsIHsKICAgICAgICAgICAgICAgIG1vbnRoOiAnc2hvcnQnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gZGF0ZV9vYmouZ2V0RGF0ZSgpICsgJyAnICArIG1vbnRoTmFtZTsKICAgICAgICB9LAogICAgICAgIHNjcm9sbFRvQm90dG9tKCkgewogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRwYXJlbnQuJGVsLnNjcm9sbFRvcCA9IHRoaXMuJHBhcmVudC4kZWwuc2Nyb2xsSGVpZ2h0CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0sCiAgICB1cGRhdGVkKCkgewogICAgICAgIHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTsKICAgIH0sCiAgICBtb3VudGVkKCkgewogICAgICAgIHRoaXMuc2Nyb2xsVG9Cb3R0b20oKTsKICAgIH0KfQo="},{"version":3,"sources":["ChatLog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChatLog.vue","sourceRoot":"src/views/apps/chat","sourcesContent":["<!-- =========================================================================================\n    File Name: ChatLog.vue\n    Description: Chat Application - Log of chat\n    ----------------------------------------------------------------------------------------\n    Item Name: abjcloudsolutions.com dashboard management portal\n      Author: Pixinvent\n    Author URL: http://www.themeforest.net/user/pixinvent\n========================================================================================== -->\n\n<template>\n    <div id=\"component-chat-log\" class=\"m-8\" v-if=\"chatData\">\n        <div v-for=\"(msg, index) in chatData.msg\" class=\"msg-grp-container\" :key=\"index\">\n\n            <!-- If previous msg is older than current time -->\n            <template v-if=\"chatData.msg[index-1]\">\n                <vs-divider v-if=\"!isSameDay(msg.time, chatData.msg[index-1].time)\" class=\"msg-time\">\n                    <span>{{ toDate(msg.time) }}</span>\n                </vs-divider>\n                <div class=\"spacer mt-8\" v-if=\"!hasSentPreviousMsg(chatData.msg[index-1].isSent, msg.isSent)\"></div>\n            </template>\n\n            <div class=\"flex items-start\" :class=\"[{'flex-row-reverse' : msg.isSent}]\">\n\n                <template v-if=\"chatData.msg[index-1]\">\n                    <template v-if=\"(!hasSentPreviousMsg(chatData.msg[index-1].isSent, msg.isSent) || !isSameDay(msg.time, chatData.msg[index-1].time))\">\n                        <vs-avatar size=\"40px\" class=\"border-2 shadow border-solid border-white m-0 flex-shrink-0\" :class=\"msg.isSent ? 'sm:ml-5 ml-3' : 'sm:mr-5 mr-3'\" :src=\"senderImg(msg.isSent)\"></vs-avatar>\n                    </template>\n                </template>\n\n                <template v-if=\"index == 0\">\n                    <vs-avatar size=\"40px\" class=\"border-2 shadow border-solid border-white m-0 flex-shrink-0\" :class=\"msg.isSent ? 'sm:ml-5 ml-3' : 'sm:mr-5 mr-3'\" :src=\"senderImg(msg.isSent)\"></vs-avatar>\n                </template>\n\n                <template v-if=\"chatData.msg[index-1]\">\n                    <div class=\"mr-16\" v-if=\"!(!hasSentPreviousMsg(chatData.msg[index-1].isSent, msg.isSent) || !isSameDay(msg.time, chatData.msg[index-1].time))\"></div>\n                </template>\n\n                <div class=\"msg break-words relative shadow-md rounded py-3 px-4 mb-2 rounded-lg max-w-sm\" :class=\"{'bg-primary-gradient text-white': msg.isSent, 'border border-solid border-grey-light bg-white': !msg.isSent}\">\n                    <span>{{ msg.textContent }}</span>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nexport default{\n    props: {\n        userId: {\n            type: Number,\n            required: true,\n        }\n    },\n    computed: {\n        chatData() {\n            return this.$store.getters['chat/chatDataOfUser'](this.userId);\n        },\n        activeUserImg() {\n            return this.$store.state.AppActiveUser.photoURL;\n        },\n        senderImg() {\n            return (isSentByActiveUser) => {\n                if (isSentByActiveUser) return this.$store.state.AppActiveUser.photoURL\n                else return this.$store.getters['chat/contact'](this.userId).photoURL\n            }\n        },\n        hasSentPreviousMsg() {\n            return (last_sender, current_sender) => last_sender == current_sender\n        },\n    },\n    methods: {\n        isSameDay(time_to, time_from) {\n            const date_time_to = new Date(Date.parse(time_to))\n            const date_time_from = new Date(Date.parse(time_from));\n            return date_time_to.getFullYear() === date_time_from.getFullYear() &&\n                date_time_to.getMonth() === date_time_from.getMonth() &&\n                date_time_to.getDate() === date_time_from.getDate();\n        },\n        toDate(time) {\n            const locale = \"en-us\";\n            const date_obj = new Date(Date.parse(time));\n            const monthName= date_obj.toLocaleString(locale, {\n                month: 'short'\n            });\n            return date_obj.getDate() + ' '  + monthName;\n        },\n        scrollToBottom() {\n            this.$nextTick(() => {\n                this.$parent.$el.scrollTop = this.$parent.$el.scrollHeight\n            });\n        }\n    },\n    updated() {\n        this.scrollToBottom();\n    },\n    mounted() {\n        this.scrollToBottom();\n    }\n}\n</script>\n"]}]}