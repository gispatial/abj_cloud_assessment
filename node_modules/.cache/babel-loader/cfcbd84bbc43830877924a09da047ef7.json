{"remainingRequest":"/Users/crocslut/Desktop/abj_cloud_assessment/node_modules/babel-loader/lib/index.js!/Users/crocslut/Desktop/abj_cloud_assessment/src/auth/authService.js","dependencies":[{"path":"/Users/crocslut/Desktop/abj_cloud_assessment/src/auth/authService.js","mtime":1634797132075},{"path":"/Users/crocslut/Desktop/abj_cloud_assessment/node_modules/cache-loader/dist/cjs.js","mtime":1634797146168},{"path":"/Users/crocslut/Desktop/abj_cloud_assessment/node_modules/babel-loader/lib/index.js","mtime":1634797145766}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXM2LnJlZ2V4cC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lczYuZGF0ZS50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lczYucmVmbGVjdC5jb25zdHJ1Y3QiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lczYuZGF0ZS5ub3ciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lczYuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lczYuc3RyaW5nLnN1YiI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzNi5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMvY3JvY3NsdXQvRGVza3RvcC9hYmpfY2xvdWRfYXNzZXNzbWVudC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUtY29yZWpzMi9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL2Nyb2NzbHV0L0Rlc2t0b3AvYWJqX2Nsb3VkX2Fzc2Vzc21lbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lLWNvcmVqczIvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2Fzc2VydFRoaXNJbml0aWFsaXplZCBmcm9tICIvVXNlcnMvY3JvY3NsdXQvRGVza3RvcC9hYmpfY2xvdWRfYXNzZXNzbWVudC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUtY29yZWpzMi9oZWxwZXJzL2VzbS9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9Vc2Vycy9jcm9jc2x1dC9EZXNrdG9wL2Fial9jbG91ZF9hc3Nlc3NtZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS1jb3JlanMyL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIi9Vc2Vycy9jcm9jc2x1dC9EZXNrdG9wL2Fial9jbG91ZF9hc3Nlc3NtZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS1jb3JlanMyL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIi9Vc2Vycy9jcm9jc2x1dC9EZXNrdG9wL2Fial9jbG91ZF9hc3Nlc3NtZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS1jb3JlanMyL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvVXNlcnMvY3JvY3NsdXQvRGVza3RvcC9hYmpfY2xvdWRfYXNzZXNzbWVudC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUtY29yZWpzMi9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CgpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQoKZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IERhdGUucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoRGF0ZSwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9CgppbXBvcnQgYXV0aDAgZnJvbSAnYXV0aDAtanMnOwppbXBvcnQgRXZlbnRFbWl0dGVyIGZyb20gJ2V2ZW50cyc7CmltcG9ydCBhdXRoQ29uZmlnIGZyb20gJ0AvLi4vYXV0aF9jb25maWcuanNvbic7CmltcG9ydCBzdG9yZSBmcm9tICJAL3N0b3JlL3N0b3JlLmpzIjsgLy8gJ2xvZ2dlZEluJyBpcyB1c2VkIGluIG90aGVyIHBhcnRzIG9mIGFwcGxpY2F0aW9uLiBTbywgRG9uJ3QgZm9yZ2V0IHRvIGNoYW5nZSB0aGVyZSBhbHNvCgp2YXIgbG9jYWxTdG9yYWdlS2V5ID0gJ2xvZ2dlZEluJzsKdmFyIHRva2VuRXhwaXJ5S2V5ID0gJ3Rva2VuRXhwaXJ5JzsKdmFyIGxvZ2luRXZlbnQgPSAnbG9naW5FdmVudCc7CnZhciB3ZWJBdXRoID0gbmV3IGF1dGgwLldlYkF1dGgoewogIGRvbWFpbjogYXV0aENvbmZpZy5kb21haW4sCiAgcmVkaXJlY3RVcmk6IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyBwcm9jZXNzLmVudi5CQVNFX1VSTCArICJjYWxsYmFjayIsCiAgY2xpZW50SUQ6IGF1dGhDb25maWcuY2xpZW50SWQsCiAgcmVzcG9uc2VUeXBlOiAnaWRfdG9rZW4nLAogIHNjb3BlOiAnb3BlbmlkIHByb2ZpbGUgZW1haWwnCn0pOwoKdmFyIEF1dGhTZXJ2aWNlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfRXZlbnRFbWl0dGVyKSB7CiAgX2luaGVyaXRzKEF1dGhTZXJ2aWNlLCBfRXZlbnRFbWl0dGVyKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihBdXRoU2VydmljZSk7CgogIGZ1bmN0aW9uIEF1dGhTZXJ2aWNlKCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBdXRoU2VydmljZSk7CgogICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7CiAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICB9CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbC5hcHBseShfc3VwZXIsIFt0aGlzXS5jb25jYXQoYXJncykpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eShfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzKSwgImlkVG9rZW4iLCBudWxsKTsKCiAgICBfZGVmaW5lUHJvcGVydHkoX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpcyksICJwcm9maWxlIiwgbnVsbCk7CgogICAgX2RlZmluZVByb3BlcnR5KF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMpLCAidG9rZW5FeHBpcnkiLCBudWxsKTsKCiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQXV0aFNlcnZpY2UsIFt7CiAgICBrZXk6ICJsb2dpbiIsCiAgICAvLyBTdGFydHMgdGhlIHVzZXIgbG9naW4gZmxvdwogICAgdmFsdWU6IGZ1bmN0aW9uIGxvZ2luKGN1c3RvbVN0YXRlKSB7CiAgICAgIHdlYkF1dGguYXV0aG9yaXplKHsKICAgICAgICBhcHBTdGF0ZTogY3VzdG9tU3RhdGUKICAgICAgfSk7CiAgICB9IC8vIEhhbmRsZXMgdGhlIGNhbGxiYWNrIHJlcXVlc3QgZnJvbSBBdXRoMAoKICB9LCB7CiAgICBrZXk6ICJoYW5kbGVBdXRoZW50aWNhdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlQXV0aGVudGljYXRpb24oKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB3ZWJBdXRoLnBhcnNlSGFzaChmdW5jdGlvbiAoZXJyLCBhdXRoUmVzdWx0KSB7CiAgICAgICAgICBpZiAoZXJyKSB7CiAgICAgICAgICAgIGFsZXJ0KGVyci5lcnJvciArICcuIERldGFpbGVkIGVycm9yIGNhbiBiZSBmb3VuZCBpbiBjb25zb2xlLicpOwogICAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzMi5sb2NhbExvZ2luKGF1dGhSZXN1bHQpOwoKICAgICAgICAgICAgcmVzb2x2ZShhdXRoUmVzdWx0LmlkVG9rZW4pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2NhbExvZ2luIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2NhbExvZ2luKGF1dGhSZXN1bHQpIHsKICAgICAgdGhpcy5pZFRva2VuID0gYXV0aFJlc3VsdC5pZFRva2VuOwogICAgICB0aGlzLnByb2ZpbGUgPSBhdXRoUmVzdWx0LmlkVG9rZW5QYXlsb2FkOyAvLyBDb252ZXJ0IHRoZSBKV1QgZXhwaXJ5IHRpbWUgZnJvbSBzZWNvbmRzIHRvIG1pbGxpc2Vjb25kcwoKICAgICAgdGhpcy50b2tlbkV4cGlyeSA9IG5ldyBEYXRlKHRoaXMucHJvZmlsZS5leHAgKiAxMDAwKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0odG9rZW5FeHBpcnlLZXksIHRoaXMudG9rZW5FeHBpcnkpOwogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShsb2NhbFN0b3JhZ2VLZXksICd0cnVlJyk7CiAgICAgIHN0b3JlLmNvbW1pdCgiVVBEQVRFX1VTRVJfSU5GTyIsIHsKICAgICAgICBkaXNwbGF5TmFtZTogdGhpcy5wcm9maWxlLm5hbWUsCiAgICAgICAgZW1haWw6IHRoaXMucHJvZmlsZS5lbWFpbCwKICAgICAgICBwaG90b1VSTDogdGhpcy5wcm9maWxlLnBpY3R1cmUsCiAgICAgICAgcHJvdmlkZXJJZDogdGhpcy5wcm9maWxlLnN1Yi5zdWJzdHIoMCwgdGhpcy5wcm9maWxlLnN1Yi5pbmRleE9mKCd8JykpLAogICAgICAgIHVpZDogdGhpcy5wcm9maWxlLnN1YgogICAgICB9KTsKICAgICAgdGhpcy5lbWl0KGxvZ2luRXZlbnQsIHsKICAgICAgICBsb2dnZWRJbjogdHJ1ZSwKICAgICAgICBwcm9maWxlOiBhdXRoUmVzdWx0LmlkVG9rZW5QYXlsb2FkLAogICAgICAgIHN0YXRlOiBhdXRoUmVzdWx0LmFwcFN0YXRlIHx8IHt9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbmV3VG9rZW5zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW5ld1Rva2VucygpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICAvLyByZWplY3QgY2FuIGJlIHVzZWQgYXMgcGFyYW1ldGVyIGluIHByb21pc2UgZm9yIHVzaW5nIHJlamVjdAogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0obG9jYWxTdG9yYWdlS2V5KSAhPT0gInRydWUiKSB7Ly8gcmV0dXJuIHJlamVjdCgiTm90IGxvZ2dlZCBpbiIpOwogICAgICAgIH0KCiAgICAgICAgd2ViQXV0aC5jaGVja1Nlc3Npb24oe30sIGZ1bmN0aW9uIChlcnIsIGF1dGhSZXN1bHQpIHsKICAgICAgICAgIGlmIChlcnIpIHsvLyByZWplY3QoZXJyKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzMy5sb2NhbExvZ2luKGF1dGhSZXN1bHQpOwoKICAgICAgICAgICAgcmVzb2x2ZShhdXRoUmVzdWx0KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9nT3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2dPdXQoKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGxvY2FsU3RvcmFnZUtleSk7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKHRva2VuRXhwaXJ5S2V5KTsKICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJJbmZvJyk7CiAgICAgIHRoaXMuaWRUb2tlbiA9IG51bGw7CiAgICAgIHRoaXMudG9rZW5FeHBpcnkgPSBudWxsOwogICAgICB0aGlzLnByb2ZpbGUgPSBudWxsOwogICAgICB3ZWJBdXRoLmxvZ291dCh7CiAgICAgICAgcmV0dXJuVG86IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4gKyBwcm9jZXNzLmVudi5CQVNFX1VSTAogICAgICB9KTsKICAgICAgdGhpcy5lbWl0KGxvZ2luRXZlbnQsIHsKICAgICAgICBsb2dnZWRJbjogZmFsc2UKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNBdXRoZW50aWNhdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7CiAgICAgIHJldHVybiBuZXcgRGF0ZShEYXRlLm5vdygpKSA8IG5ldyBEYXRlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRva2VuRXhwaXJ5S2V5KSkgJiYgbG9jYWxTdG9yYWdlLmdldEl0ZW0obG9jYWxTdG9yYWdlS2V5KSA9PT0gJ3RydWUnOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEF1dGhTZXJ2aWNlOwp9KEV2ZW50RW1pdHRlcik7CgpleHBvcnQgZGVmYXVsdCBuZXcgQXV0aFNlcnZpY2UoKTs="},{"version":3,"sources":["/Users/crocslut/Desktop/abj_cloud_assessment/src/auth/authService.js"],"names":["auth0","EventEmitter","authConfig","store","localStorageKey","tokenExpiryKey","loginEvent","webAuth","WebAuth","domain","redirectUri","window","location","origin","process","env","BASE_URL","clientID","clientId","responseType","scope","AuthService","customState","authorize","appState","Promise","resolve","reject","parseHash","err","authResult","alert","error","localLogin","idToken","profile","idTokenPayload","tokenExpiry","Date","exp","localStorage","setItem","commit","displayName","name","email","photoURL","picture","providerId","sub","substr","indexOf","uid","emit","loggedIn","state","getItem","checkSession","removeItem","logout","returnTo","now"],"mappings":"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","sourcesContent":["import auth0 from 'auth0-js'\nimport EventEmitter from 'events'\nimport authConfig from '@/../auth_config.json'\n\nimport store from \"@/store/store.js\"\n\n// 'loggedIn' is used in other parts of application. So, Don't forget to change there also\nconst localStorageKey = 'loggedIn';\n\nconst tokenExpiryKey = 'tokenExpiry';\nconst loginEvent = 'loginEvent';\n\nconst webAuth = new auth0.WebAuth({\n    domain: authConfig.domain,\n    redirectUri: window.location.origin + process.env.BASE_URL + \"callback\",\n    clientID: authConfig.clientId,\n    responseType: 'id_token',\n    scope: 'openid profile email'\n});\n\nclass AuthService extends EventEmitter {\n    idToken = null;\n    profile = null;\n    tokenExpiry = null;\n\n    // Starts the user login flow\n    login(customState) {\n        webAuth.authorize({\n            appState: customState\n        });\n    }\n\n    // Handles the callback request from Auth0\n    handleAuthentication() {\n        return new Promise((resolve, reject) => {\n            webAuth.parseHash((err, authResult) => {\n                if (err) {\n                    alert(err.error + '. Detailed error can be found in console.');\n                    reject(err);\n                } else {\n                    this.localLogin(authResult);\n                    resolve(authResult.idToken);\n                }\n            });\n        });\n    }\n\n    localLogin(authResult) {\n        this.idToken = authResult.idToken;\n        this.profile = authResult.idTokenPayload;\n\n        // Convert the JWT expiry time from seconds to milliseconds\n        this.tokenExpiry = new Date(this.profile.exp * 1000);\n        localStorage.setItem(tokenExpiryKey, this.tokenExpiry);\n        localStorage.setItem(localStorageKey, 'true');\n\n        store.commit(\"UPDATE_USER_INFO\", {\n            displayName: this.profile.name,\n            email: this.profile.email,\n            photoURL: this.profile.picture,\n            providerId: this.profile.sub.substr(0, this.profile.sub.indexOf('|')),\n            uid: this.profile.sub\n        })\n\n        this.emit(loginEvent, {\n            loggedIn: true,\n            profile: authResult.idTokenPayload,\n            state: authResult.appState || {}\n        });\n    }\n\n    renewTokens() {\n        // reject can be used as parameter in promise for using reject\n        return new Promise((resolve) => {\n            if (localStorage.getItem(localStorageKey) !== \"true\") {\n                // return reject(\"Not logged in\");\n            }\n\n            webAuth.checkSession({}, (err, authResult) => {\n                if (err) {\n                    // reject(err);\n                } else {\n                    this.localLogin(authResult);\n                    resolve(authResult);\n                }\n            });\n        });\n    }\n\n    logOut() {\n        localStorage.removeItem(localStorageKey);\n        localStorage.removeItem(tokenExpiryKey);\n        localStorage.removeItem('userInfo');\n\n        this.idToken = null;\n        this.tokenExpiry = null;\n        this.profile = null;\n\n        webAuth.logout({\n            returnTo: window.location.origin + process.env.BASE_URL\n        });\n\n        this.emit(loginEvent, { loggedIn: false });\n    }\n\n    isAuthenticated() {\n        return (\n            new Date(Date.now()) < new Date(localStorage.getItem(tokenExpiryKey)) &&\n            localStorage.getItem(localStorageKey) === 'true'\n        );\n    }\n}\n\nexport default new AuthService();\n"]}]}