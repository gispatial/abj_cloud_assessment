{"remainingRequest":"/Users/crocslut/Documents/Git/abj_cloud_assessment/node_modules/babel-loader/lib/index.js!/Users/crocslut/Documents/Git/abj_cloud_assessment/src/http/requests/auth/jwt/index.js","dependencies":[{"path":"/Users/crocslut/Documents/Git/abj_cloud_assessment/src/http/requests/auth/jwt/index.js","mtime":1634372945930},{"path":"/Users/crocslut/Documents/Git/abj_cloud_assessment/node_modules/cache-loader/dist/cjs.js","mtime":1634370900025},{"path":"/Users/crocslut/Documents/Git/abj_cloud_assessment/node_modules/babel-loader/lib/index.js","mtime":1634273594024}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGF4aW9zIGZyb20gIi4uLy4uLy4uL2F4aW9zL2luZGV4LmpzIjsKaW1wb3J0IHN0b3JlIGZyb20gIi4uLy4uLy4uLy4uL3N0b3JlL3N0b3JlLmpzIjsKaW1wb3J0IFZhcGkgZnJvbSAidnVleC1yZXN0LWFwaSI7Ci8qCi8vIFRva2VuIFJlZnJlc2gKbGV0IGlzQWxyZWFkeUZldGNoaW5nQWNjZXNzVG9rZW4gPSB0cnVlCmxldCBzdWJzY3JpYmVycyA9IFtdCgpmdW5jdGlvbiBvbkFjY2Vzc1Rva2VuRmV0Y2hlZChhY2Nlc3NfdG9rZW4pIHsKICBzdWJzY3JpYmVycyA9IHN1YnNjcmliZXJzLmZpbHRlcihjYWxsYmFjayA9PiBjYWxsYmFjayhhY2Nlc3NfdG9rZW4pKQp9CgpmdW5jdGlvbiBhZGRTdWJzY3JpYmVyKGNhbGxiYWNrKSB7CiAgc3Vic2NyaWJlcnMucHVzaChjYWxsYmFjaykKfQoqLwoKdmFyIGNvbmZpZyA9IHsKICBoZWFkZXJzOiB7CiAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIuY29uY2F0KGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJhY2Nlc3NUb2tlbiIpKQogIH0KfTsKdmFyIGJvZHlQYXJhbWV0ZXJzID0gewogIGtleTogInZhbHVlIgp9OwpleHBvcnQgZGVmYXVsdCB7CiAgLyoKICBpbml0KCkgewogICAgYXhpb3MuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLnVzZShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgcmV0dXJuIHJlc3BvbnNlCiAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgLy8gY29uc3QgeyBjb25maWcsIHJlc3BvbnNlOiB7IHN0YXR1cyB9IH0gPSBlcnJvcgogICAgICBjb25zdCB7IGNvbmZpZywgcmVzcG9uc2UgfSA9IGVycm9yCiAgICAgIGNvbnN0IG9yaWdpbmFsUmVxdWVzdCA9IGNvbmZpZwogICAgICAgLy8gaWYgKHN0YXR1cyA9PT0gNDAxKSB7CiAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgIGlmICghaXNBbHJlYWR5RmV0Y2hpbmdBY2Nlc3NUb2tlbikgewogICAgICAgICAgaXNBbHJlYWR5RmV0Y2hpbmdBY2Nlc3NUb2tlbiA9IHRydWUKICAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCJhdXRoL2ZldGNoQWNjZXNzVG9rZW4iKQogICAgICAgICAgICAudGhlbigoYWNjZXNzX3Rva2VuKSA9PiB7CiAgICAgICAgICAgICAgaXNBbHJlYWR5RmV0Y2hpbmdBY2Nlc3NUb2tlbiA9IGZhbHNlCiAgICAgICAgICAgICAgb25BY2Nlc3NUb2tlbkZldGNoZWQoYWNjZXNzX3Rva2VuKQogICAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgICAgY29uc3QgcmV0cnlPcmlnaW5hbFJlcXVlc3QgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgICAgYWRkU3Vic2NyaWJlcihhY2Nlc3NfdG9rZW4gPT4gewogICAgICAgICAgICBvcmlnaW5hbFJlcXVlc3QuaGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgYWNjZXNzX3Rva2VuCiAgICAgICAgICAgIHJlc29sdmUoYXhpb3Mob3JpZ2luYWxSZXF1ZXN0KSkKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgICByZXR1cm4gcmV0cnlPcmlnaW5hbFJlcXVlc3QKICAgICAgfQogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpCiAgICB9KQogIH0sCiAgKi8KICBsb2dpbjogZnVuY3Rpb24gbG9naW4odW5hbWUsIHB3ZCkgewogICAgcmV0dXJuIGF4aW9zLnBvc3QoImh0dHBzOi8vcGFydG5lcnMudHJpcGNhcnRlLmFzaWEvd3AtanNvbi9qd3QtYXV0aC92MS90b2tlbiIsIHsKICAgICAgdXNlcm5hbWU6IHVuYW1lLAogICAgICBwYXNzd29yZDogcHdkCiAgICB9KTsKICB9LAogIHJlZ2lzdGVyVXNlcjogZnVuY3Rpb24gcmVnaXN0ZXJVc2VyKHVuYW1lLCBlbWFpbCwgcHdkKSB7CiAgICByZXR1cm4gYXhpb3MucG9zdCgiaHR0cHM6Ly9wYXJ0bmVycy50cmlwY2FydGUuYXNpYS93cC1qc29uL2p3dC1hdXRoL3YxL3Rva2VuL3JlZ2lzdGVyIiwgewogICAgICBkaXNwbGF5TmFtZTogdW5hbWUsCiAgICAgIGVtYWlsOiBlbWFpbCwKICAgICAgcGFzc3dvcmQ6IHB3ZAogICAgfSk7CiAgfSwKICByZWZyZXNodG9rZW46IGZ1bmN0aW9uIHJlZnJlc2h0b2tlbihlLCByZXNwb25zZSwgdHlwZSwgZWwpIHsKICAgIHJldHVybiBheGlvcy5wb3N0KCdodHRwczovL3BhcnRuZXJzLnRyaXBjYXJ0ZS5hc2lhL3dwLWpzb24vand0LWF1dGgvdjEvdG9rZW4vdmFsaWRhdGUnLCBib2R5UGFyYW1ldGVycywgY29uZmlnKTsKICB9CiAgLyoKICByZWdpc3RlclVzZXIobmFtZSwgZW1haWwsIHB3ZCkgewogICAgcmV0dXJuIGF4aW9zLnBvc3QoIi9hcGkvYXV0aC9yZWdpc3RlciIsIHtkaXNwbGF5TmFtZTogbmFtZSwgZW1haWw6IGVtYWlsLCBwYXNzd29yZDogcHdkfSkKICB9LAogIHJlZnJlc2hUb2tlbigpIHsKICAgIHJldHVybiBheGlvcy5wb3N0KCIvYXBpL2F1dGgvcmVmcmVzaC10b2tlbiIsIHthY2Nlc3NUb2tlbjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oImFjY2Vzc1RvS2VuIil9KQogIH0KICAqLwoKfTsKLyoKdmFyIG15SGVhZGVycyA9IG5ldyBIZWFkZXJzKCk7Cm15SGVhZGVycy5hcHBlbmQoInVuZGVyd2F0ZXJ3b3JsZGFkbWluIiwgImFiY2QxMjM0ISIpOwpteUhlYWRlcnMuYXBwZW5kKCJBdXRob3JpemF0aW9uIiwgIkJlYXJlciB7e3Rva2VufX0iKTsKCnZhciByZXF1ZXN0T3B0aW9ucyA9IHsKICBtZXRob2Q6ICdHRVQnLAogIGhlYWRlcnM6IG15SGVhZGVycywKICByZWRpcmVjdDogJ2ZvbGxvdycKfTsKCmZldGNoKCJodHRwczovL3BhcnRuZXJzLnRyaXBjYXJ0ZS5hc2lhL3dwLWpzb24vdHJpcGNhcnRlX2FwaS92MS9teS9yZXZpZXdzIiwgcmVxdWVzdE9wdGlvbnMpCiAgLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UudGV4dCgpKQogIC50aGVuKHJlc3VsdCA9PiBjb25zb2xlLmxvZyhyZXN1bHQpKQogIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmxvZygnZXJyb3InLCBlcnJvcikpOwogICov"},{"version":3,"sources":["/Users/crocslut/Documents/Git/abj_cloud_assessment/src/http/requests/auth/jwt/index.js"],"names":["axios","store","Vapi","config","headers","Authorization","localStorage","getItem","bodyParameters","key","login","uname","pwd","post","username","password","registerUser","email","displayName","refreshtoken","e","response","type","el"],"mappings":"AAAA,OAAOA,KAAP;AACA,OAAOC,KAAP;AACA,OAAOC,IAAP,MAAiB,eAAjB;AAEA;;;;;;;;;;;;;;AAcA,IAAMC,MAAM,GAAG;AACbC,EAAAA,OAAO,EAAE;AAAEC,IAAAA,aAAa,mBAAYC,YAAY,CAACC,OAAb,CAAqB,aAArB,CAAZ;AAAf;AADI,CAAf;AAIA,IAAMC,cAAc,GAAG;AACrBC,EAAAA,GAAG,EAAE;AADgB,CAAvB;AAIA,eAAe;AACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCAC,EAAAA,KAjCa,iBAiCPC,KAjCO,EAiCAC,GAjCA,EAiCK;AAChB,WAAOZ,KAAK,CAACa,IAAN,CAAW,2DAAX,EAAwE;AAACC,MAAAA,QAAQ,EAAEH,KAAX;AAAkBI,MAAAA,QAAQ,EAAEH;AAA5B,KAAxE,CAAP;AACD,GAnCY;AAoCbI,EAAAA,YApCa,wBAoCAL,KApCA,EAoCOM,KApCP,EAoCcL,GApCd,EAoCmB;AAC9B,WAAOZ,KAAK,CAACa,IAAN,CAAW,oEAAX,EAAiF;AAACK,MAAAA,WAAW,EAAEP,KAAd;AAAqBM,MAAAA,KAAK,EAAEA,KAA5B;AAAmCF,MAAAA,QAAQ,EAAEH;AAA7C,KAAjF,CAAP;AACD,GAtCY;AAuCbO,EAAAA,YAvCa,wBAuCAC,CAvCA,EAuCGC,QAvCH,EAuCaC,IAvCb,EAuCmBC,EAvCnB,EAuCuB;AAClC,WAAOvB,KAAK,CAACa,IAAN,CAAW,oEAAX,EAAiFL,cAAjF,EAAiGL,MAAjG,CAAP;AACD;AACD;;;;;;;;;AA1Ca,CAAf;AAmDA","sourcesContent":["import axios from \"../../../axios/index.js\"\nimport store from \"../../../../store/store.js\"\nimport Vapi from \"vuex-rest-api\"\n\n/*\n// Token Refresh\nlet isAlreadyFetchingAccessToken = true\nlet subscribers = []\n\nfunction onAccessTokenFetched(access_token) {\n  subscribers = subscribers.filter(callback => callback(access_token))\n}\n\nfunction addSubscriber(callback) {\n  subscribers.push(callback)\n}\n*/\n\nconst config = {\n  headers: { Authorization: `Bearer ${localStorage.getItem(\"accessToken\")}` }\n};\n\nconst bodyParameters = {\n  key: \"value\"\n};\n\nexport default {\n  /*\n  init() {\n    axios.interceptors.response.use(function (response) {\n      return response\n    }, function (error) {\n      // const { config, response: { status } } = error\n      const { config, response } = error\n      const originalRequest = config\n\n      // if (status === 401) {\n      if (response && response.status === 401) {\n        if (!isAlreadyFetchingAccessToken) {\n          isAlreadyFetchingAccessToken = true\n          store.dispatch(\"auth/fetchAccessToken\")\n            .then((access_token) => {\n              isAlreadyFetchingAccessToken = false\n              onAccessTokenFetched(access_token)\n            })\n        }\n\n        const retryOriginalRequest = new Promise((resolve) => {\n          addSubscriber(access_token => {\n            originalRequest.headers.Authorization = 'Bearer ' + access_token\n            resolve(axios(originalRequest))\n          })\n        })\n        return retryOriginalRequest\n      }\n      return Promise.reject(error)\n    })\n  },\n  */\n  login(uname, pwd) {\n    return axios.post(\"https://partners.tripcarte.asia/wp-json/jwt-auth/v1/token\", {username: uname, password: pwd})\n  },\n  registerUser(uname, email, pwd) {\n    return axios.post(\"https://partners.tripcarte.asia/wp-json/jwt-auth/v1/token/register\", {displayName: uname, email: email, password: pwd})\n  },\n  refreshtoken(e, response, type, el) {\n    return axios.post('https://partners.tripcarte.asia/wp-json/jwt-auth/v1/token/validate', bodyParameters, config)\n  },\n  /*\n  registerUser(name, email, pwd) {\n    return axios.post(\"/api/auth/register\", {displayName: name, email: email, password: pwd})\n  },\n  refreshToken() {\n    return axios.post(\"/api/auth/refresh-token\", {accessToken: localStorage.getItem(\"accessToKen\")})\n  }\n  */\n}\n/*\nvar myHeaders = new Headers();\nmyHeaders.append(\"underwaterworldadmin\", \"abcd1234!\");\nmyHeaders.append(\"Authorization\", \"Bearer {{token}}\");\n\nvar requestOptions = {\n  method: 'GET',\n  headers: myHeaders,\n  redirect: 'follow'\n};\n\nfetch(\"https://partners.tripcarte.asia/wp-json/tripcarte_api/v1/my/reviews\", requestOptions)\n  .then(response => response.text())\n  .then(result => console.log(result))\n  .catch(error => console.log('error', error));\n  */\n"]}]}